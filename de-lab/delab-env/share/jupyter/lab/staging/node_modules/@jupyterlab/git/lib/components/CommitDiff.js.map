{"version":3,"file":"CommitDiff.js","sourceRoot":"./@jupyterlab/git/src/","sources":["components/CommitDiff.tsx"],"names":[],"mappings":"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","sourcesContent":["import { TranslationBundle } from '@jupyterlab/translation';\nimport { fileIcon } from '@jupyterlab/ui-components';\nimport * as React from 'react';\nimport { FixedSizeList, ListChildComponentProps } from 'react-window';\nimport { classes } from 'typestyle';\nimport { getDiffProvider } from '../model';\nimport {\n  deletionsMadeIcon,\n  diffIcon,\n  insertionsMadeIcon\n} from '../style/icons';\nimport {\n  commitClass,\n  commitDetailClass,\n  commitDetailFileClass,\n  commitDetailHeaderClass,\n  commitOverviewNumbersClass,\n  deletionsIconClass,\n  fileListClass,\n  iconClass,\n  insertionsIconClass\n} from '../style/SinglePastCommitInfo';\nimport { Git } from '../tokens';\nimport { ActionButton } from './ActionButton';\nimport { FilePath } from './FilePath';\n\n/**\n * File list item height\n */\nconst ITEM_HEIGHT = 24;\n/**\n * Maximal number of file display at once\n */\nconst MAX_VISIBLE_FILES = 5;\n\n/**\n * CommitDiff component properties\n */\nexport interface ICommitDiffProps {\n  /**\n   * Global actions on the commit diff\n   */\n  actions?: JSX.Element;\n\n  /**\n   * Class name\n   */\n  className?: string;\n\n  /**\n   * Number of modified files.\n   */\n  numFiles: string;\n\n  /**\n   * Number of insertions.\n   */\n  insertions: string;\n\n  /**\n   * Number of deletions.\n   */\n  deletions: string;\n\n  /**\n   * A list of modified files.\n   */\n  files: Git.ICommitModifiedFile[];\n\n  /**\n   * The application language translator.\n   */\n  trans: TranslationBundle;\n\n  /**\n   * Returns a callback to be invoked on click to display a file diff.\n   *\n   * @param filePath file path\n   * @param isText indicates whether the file supports displaying a diff\n   * @param previousFilePath when file has been relocated\n   * @returns callback\n   */\n  onOpenDiff: (\n    filePath: string,\n    isText: boolean,\n    previousFilePath?: string\n  ) => (event: React.MouseEvent<HTMLLIElement, MouseEvent>) => void;\n}\n\n/**\n * Display differences between two commits\n */\nexport class CommitDiff extends React.PureComponent<ICommitDiffProps> {\n  render(): JSX.Element {\n    return (\n      <div className={this.props.className}>\n        <div className={commitClass}>\n          <div className={commitOverviewNumbersClass}>\n            <span title={this.props.trans.__('# Files Changed')}>\n              <fileIcon.react className={iconClass} tag=\"span\" />\n              {this.props.numFiles}\n            </span>\n            <span title={this.props.trans.__('# Insertions')}>\n              <insertionsMadeIcon.react\n                className={classes(iconClass, insertionsIconClass)}\n                tag=\"span\"\n              />\n              {this.props.insertions}\n            </span>\n            <span title={this.props.trans.__('# Deletions')}>\n              <deletionsMadeIcon.react\n                className={classes(iconClass, deletionsIconClass)}\n                tag=\"span\"\n              />\n              {this.props.deletions}\n            </span>\n          </div>\n        </div>\n        <div className={commitDetailClass}>\n          <div className={commitDetailHeaderClass}>\n            {this.props.trans.__('Changed')}\n            {this.props.actions ?? null}\n          </div>\n          {this.props.files.length > 0 && (\n            <FixedSizeList\n              className={fileListClass}\n              height={\n                Math.min(MAX_VISIBLE_FILES, this.props.files.length) *\n                ITEM_HEIGHT\n              }\n              innerElementType=\"ul\"\n              itemCount={this.props.files.length}\n              itemData={this.props.files}\n              itemKey={(index, data) => data[index].modified_file_path}\n              itemSize={ITEM_HEIGHT}\n              style={{ overflowX: 'hidden' }}\n              width={'auto'}\n            >\n              {this._renderFile}\n            </FixedSizeList>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  private _renderFile = (props: ListChildComponentProps): JSX.Element => {\n    const { data, index, style } = props;\n    const file = data[index];\n    const path = file.modified_file_path;\n    const previous = file.previous_file_path;\n    const flg = !!getDiffProvider(path) || !file.is_binary;\n    return (\n      <li\n        className={commitDetailFileClass}\n        onClick={this.props.onOpenDiff(path, flg, previous)}\n        style={style}\n        title={path}\n      >\n        <FilePath filepath={path} filetype={file.type} />\n        {flg ? (\n          <ActionButton\n            icon={diffIcon}\n            title={this.props.trans.__('View file changes')}\n          />\n        ) : null}\n      </li>\n    );\n  };\n}\n"]}